<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Valentine's Quiz</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    body {
      background: linear-gradient(180deg, #ffd0e5 0%, #ffe8f2 36%, #ffffff 100%);
    }

    .option-btn {
      transition: all 0.2s ease;
    }

    .option-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(189, 30, 89, 0.3);
    }

    .correct { background: #22c55e !important; color: white; }
    .wrong { background: #ef4444 !important; color: white; }

    .bounce {
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-15px); }
      60% { transform: translateY(-8px); }
    }
  </style>
</head>

<body class="min-h-screen flex items-center justify-center px-4">

<div class="w-full max-w-2xl">

  <!-- QUIZ -->
  <div id="quizScreen" class="bg-white rounded-2xl shadow-xl p-6">
    <div class="flex justify-between mb-4">
      <div class="font-semibold text-pink-700">
        Question <span id="qNumber">1</span>/<span id="qTotal">5</span>
      </div>
      <div class="font-bold text-pink-700">
        Score: <span id="score">0</span>
      </div>
    </div>

    <h2 id="question" class="text-xl font-bold mb-6"></h2>
    <div id="options" class="space-y-3"></div>
  </div>

  <!-- RETRY -->
  <div id="retryScreen" class="hidden bg-white rounded-2xl shadow-xl p-8 text-center">
    <h2 class="text-3xl font-bold text-pink-700 mb-4">You don't love me ðŸ˜¢</h2>
    <p class="mb-6">Score: <span id="finalScore"></span></p>
    <button id="retryBtn" class="bounce bg-pink-600 text-white px-8 py-3 rounded-lg">
      Try Again
    </button>
  </div>

  <!-- VALENTINE -->
  <div id="valentineScreen" class="hidden text-center">
    <img id="valImage" src="./images/image1.gif" class="mx-auto h-64 mb-4"/>
    <h2 id="valText" class="text-3xl font-bold text-pink-700">
      Will you be my Valentine?
    </h2>

    <!-- Escalation text -->
    <p id="noReactionText" class="text-lg text-gray-600 mt-2 min-h-[28px]"></p>

    <div id="valButtons" class="flex gap-4 justify-center mt-6">
      <button id="yesBtn" class="bounce bg-green-500 text-white px-6 py-3 rounded-lg">
        Yes
      </button>
      <button id="noBtn" class="bg-red-500 text-white px-6 py-3 rounded-lg">
        No
      </button>
    </div>
  </div>

</div>

<script>
/* ------------------ QUIZ DATA ------------------ */

const quizData = [
  { q: "What do we usually do when we finally get time together?", options: [
    "Spent whole day in bed talking and cuddling",
    "Watch movies",
    "Go out for romantic dinner",
    "All of above"], correct: 3 },

  { q: "What is our most memorable trip?", options: ["Udaipur", "Darjeeling", "Jaipur", "Pune (recent)"], correct: 0 },
  { q: "Things that i love about you?", options: ["Eyes", "Smile", "Hairs", "Everything"], correct: 3 },
  { q: "What is my fav dish that you cook?", options: ["Pancakes", "Maggie", "dosa", "rice"], correct: 1 },
  { q: "What isWhat do we always promise each other, no matter what?", options: ["To stay perfect", "To never fight", "Always resolve a fight", "Never apologize"], correct: 2 }
];

const PASS_SCORE = 4;

/* ------------------ STATE ------------------ */

const state = {
  index: 0,
  score: 0,
  phase: "quiz"
};

/* ------------------ ELEMENTS ------------------ */

const quizScreen = document.getElementById("quizScreen");
const retryScreen = document.getElementById("retryScreen");
const valentineScreen = document.getElementById("valentineScreen");

const qNumber = document.getElementById("qNumber");
const qTotal = document.getElementById("qTotal");
const scoreEl = document.getElementById("score");
const questionEl = document.getElementById("question");
const optionsEl = document.getElementById("options");

const finalScoreEl = document.getElementById("finalScore");
const retryBtn = document.getElementById("retryBtn");

const valImage = document.getElementById("valImage");
const valText = document.getElementById("valText");
const noReactionText = document.getElementById("noReactionText");
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");

/* ------------------ RENDER ------------------ */

function render() {
  quizScreen.classList.add("hidden");
  retryScreen.classList.add("hidden");
  valentineScreen.classList.add("hidden");

  if (state.phase === "quiz") renderQuiz();
  if (state.phase === "retry") renderRetry();
  if (state.phase === "valentine") renderValentine();
}

function renderQuiz() {
  quizScreen.classList.remove("hidden");

  const q = quizData[state.index];
  qNumber.textContent = state.index + 1;
  qTotal.textContent = quizData.length;
  scoreEl.textContent = state.score;
  questionEl.textContent = q.q;

  optionsEl.innerHTML = "";
  q.options.forEach((opt, i) => {
    const btn = document.createElement("button");
    btn.className = "option-btn w-full text-left px-4 py-3 border-2 rounded-xl";
    btn.textContent = opt;
    btn.onclick = () => handleAnswer(i, btn);
    optionsEl.appendChild(btn);
  });
}

/* ------------------ QUIZ LOGIC ------------------ */

function handleAnswer(index, btn) {
  const q = quizData[state.index];
  const buttons = optionsEl.querySelectorAll("button");
  buttons.forEach(b => b.disabled = true);

  if (index === q.correct) {
    state.score++;
    btn.classList.add("correct");
  } else {
    btn.classList.add("wrong");
    buttons[q.correct].classList.add("correct");
  }

  setTimeout(() => {
    if (state.index < quizData.length - 1) {
      state.index++;
      render();
    } else {
      state.phase = state.score >= PASS_SCORE ? "valentine" : "retry";
      render();
    }
  }, 800);
}

/* ------------------ RETRY ------------------ */

function renderRetry() {
  retryScreen.classList.remove("hidden");
  finalScoreEl.textContent = `${state.score}/${quizData.length}`;
}

retryBtn.onclick = () => {
  state.index = 0;
  state.score = 0;
  state.phase = "quiz";
  render();
};

/* ------------------ VALENTINE FLOW ------------------ */

let noCount = 0;

const images = [
  "image1.gif","image2.gif","image3.gif",
  "image4.gif","image5.gif","image6.gif","image7.gif"
];

const noMessages = [
  "Are you sure?",
  "Please ðŸ¥º",
  "Don't do this to me :(",
  "You're breaking my heart ðŸ’”",
  "Nooooooo ðŸ˜¢",
];

function renderValentine() {
  valentineScreen.classList.remove("hidden");
  resetValentine();
}

function resetValentine() {
  noCount = 0;
  valImage.src = "./images/image1.gif";
  valText.textContent = "Will you be my Valentine?";
  noReactionText.textContent = "";
  yesBtn.style.cssText = "";
  noBtn.style.position = "static";
  noBtn.onmouseenter = null;
}

noBtn.onclick = () => {
  if (noCount >= noMessages.length) {
    makeNoButtonRunAway();
    return;
  }

  noReactionText.textContent = noMessages[noCount];
  noCount++;

  valImage.src = `./images/${images[Math.min(noCount, images.length - 1)]}`;
  yesBtn.style.transform = `scale(${1 + noCount * 0.25})`;
};

yesBtn.onclick = () => {
  // Update image on YES
  valImage.src = "./images/image7.gif"; // or any final happy gif

  valText.textContent = "Looks like youâ€™re stuck with meâ€”youâ€™re my Valentine, now and forever â¤ï¸";
  document.getElementById("valButtons").style.display = "none";
  noReactionText.textContent = "";

  confetti();
};

function makeNoButtonRunAway() {
  noBtn.style.position = "fixed";

  const move = () => {
    const x = Math.random() * (window.innerWidth - noBtn.offsetWidth);
    const y = Math.random() * (window.innerHeight - noBtn.offsetHeight);
    noBtn.style.left = `${x}px`;
    noBtn.style.top = `${y}px`;
  };

  noBtn.onmouseenter = move;
  noBtn.onclick = move;
  move();
}

/* ------------------ START ------------------ */

render();
</script>

</body>
</html>
